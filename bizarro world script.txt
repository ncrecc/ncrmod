Rules.setalternate(~all~); Rules.excludeenemies(getcolumn(loaddata(~diceydungeons/excludedenemies~)[;] ~inventor5~));

var randeqa = null; /*hammer equivalent*/
var randeqb = null; /*pea shooter equivalent*/
var randeqc = null; /*spanner equivalent*/

var allequipmentlarge = shuffle(getequipmentlist(null|['large']|['excludefromrandomlists'|'robotonly'|'witchonly'|'alternateversion']));
var allequipmentsmall = shuffle(getequipmentlist(null|['small']|['excludefromrandomlists'|'robotonly'|'witchonly'|'alternateversion']));

while(randeqa == null # ((randeqa.script.indexOf('attack(') == -1 # randeqa.script.split('attack(-').join('').indexOf('attack(') == -1) && randeqa.script.indexOf('drain(') == -1)) {
	randeqa = new elements.Equipment(allequipmentlarge.pop());
}

while(randeqb == null # ((randeqb.script.indexOf('attack(') == -1 # randeqb.script.split('attack(-').join('').indexOf('attack(') == -1) && randeqb.script.indexOf('drain(') == -1)) {
	randeqb = new elements.Equipment(allequipmentsmall.pop());
}

while(randeqc == null # (randeqc.script.indexOf('givedice(') == -1 && randeqc.script.indexOf('.animatereroll') == -1)) {
	randeqc = new elements.Equipment(allequipmentsmall.pop());
}

self.equipment = [randeqa|randeqb|randeqc].concat([self.equipment[self.equipment.length - 1]]);

Gadget.changegadget(self| Gadget.getcurrentgadget(self) |rand(loadtext('ncrmod/randomstartinggadget')));